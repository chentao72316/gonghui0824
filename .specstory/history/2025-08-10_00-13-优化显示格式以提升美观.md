<!-- Generated by SpecStory -->

# 优化显示格式以提升美观 (2025-08-10 08:13:11)

_**User**_

请优化下显示格式，行与行之间删除空白或空行，这样更显紧凑美观简洁，不占用太多页面

---

_**Assistant**_

我来帮你优化显示格式，让页面更紧凑美观。首先让我查看一下项目的文件结构，找到相关的代码文件。


---

<details>
            <summary>Listed current directory • **35** results</summary>
        
| Name |
|-------|
| 📁 `__pycache__` |
| 📄 `db_manager.py` |
| 📄 `feedback.db` |
| 📄 `工单2驳回流转问题修复报告.md` |
| 📄 `export_manager.py` |
| 📄 `工单流转信息增强完成报告.md` |
| 📄 `工单处理流程显示修复报告.md` |
| 📄 `协同工单功能增强完成报告.md` |
| 📄 `时间统一北京时间修复报告.md` |
| 📄 `数据库结构修复报告.md` |
| 📄 `feedback_backup_20250809_103113.db` |
| 📄 `业务部门工单操作类型优化完成报告.md` |
| 📄 `多部门受理支持完成报告.md` |
| 📄 `多部门受理支持实施方案.md` |
| 📄 `工单调度权限控制修正报告.md` |
| 📄 `工单状态转换规则梳理报告.md` |
| 📄 `update_work_orders.py` |
| 📄 `工单状态规则修正方案.md` |
| 📄 `工单统计和权限显示修复报告.md` |
| 📄 `工单状态判断逻辑修复报告.md` |
| 📄 `工单调度语法错误修复报告.md` |
| 📄 `工单调度显示规则调整完成报告.md` |
| 📄 `工单调度显示规则调整报告.md` |
| 📁 `.git` |
| 📄 `app.py` |
| 📄 `auth_manager.py` |
| 📁 `exports` |
| 📁 `uploads` |
| 📁 `pages` |
| 📁 `txt` |
| 📄 `requirements.txt` |
| 📄 `.gitignore` |
| 📁 `.idea` |
| 📄 `.cursorindexingignore` |
| 📁 `.specstory` |

</details>

---

看起来这是一个Streamlit应用。让我查看一下主要的应用文件和页面文件，找到显示"一线心声"界面的相关代码。


---

Read file: app.py

---

让我查看显示所有帖子的相关代码部分：


---

Read file: app.py

---

让我继续查看这个函数的剩余部分：


---

Read file: app.py

---

现在让我查看CSS样式部分，了解当前的间距设置：


---

Read file: app.py

---

让我继续查看CSS样式的剩余部分：


---

Read file: app.py

---

现在我已经了解了代码结构。让我优化显示格式，减少行与行之间的空白，让页面更紧凑美观。主要需要优化的地方包括：

1. 减少卡片之间的间距
2. 减少卡片内部的padding和margin
3. 减少标题、内容、元数据之间的间距
4. 优化按钮行的布局


---

```diff
          color: #1f77b4;
          text-align: center;
-         margin-bottom: 2rem;
-         padding: 1rem;
+         margin-bottom: 1rem;
+         padding: 0.5rem;
          background: linear-gradient(90deg, #f0f8ff, #e6f3ff);
          border-radius: 10px;
          border: 1px solid #e0e0e0;
          border-radius: 8px;
-         padding: 15px;
-         margin-bottom: 15px;
+         padding: 10px;
+         margin-bottom: 8px;
          box-shadow: 0 2px 5px rgba(0,0,0,0.05);
          transition: all 0.3s ease;
          justify-content: space-between;
          align-items: flex-start;
-         margin-bottom: 10px;
+         margin-bottom: 6px;
          position: relative;
          z-index: 1;
          color: #666;
          font-size: 0.9rem;
-         margin-bottom: 8px;
+         margin-bottom: 6px;
          background: #f8f9fa;
-         padding: 5px 10px;
+         padding: 4px 8px;
          border-radius: 5px;
          border-left: 3px solid #007bff;
      .post-content {
          color: #333;
-         line-height: 1.6;
-         margin-bottom: 10px;
+         line-height: 1.4;
+         margin-bottom: 6px;
          max-height: 60px;
          overflow: hidden;
          font-size: 0.85rem;
          color: #666;
-         margin-top: 10px;
-         padding-top: 10px;
+         margin-top: 6px;
+         padding-top: 6px;
          border-top: 1px solid #f0f0f0;
          position: relative;
          display: flex;
          align-items: center;
-         gap: 15px;
+         gap: 10px;
          flex-wrap: nowrap;
          justify-content: flex-start;
  .post-card {
      position: relative !important;
-     margin-bottom: 15px !important;
+     margin-bottom: 8px !important;
  }
  
```

---

现在让我优化HTML卡片结构，减少内部的间距：


---

```diff
                  # 使用简化的安全HTML结构
                  simple_card_html = f"""
-                 <div class="post-card" style="border: 1px solid #ddd; padding: 15px; margin: 2px 0 0 0; border-radius: 8px; background: #f9f9f9; position: relative;" title="{content_safe}">
-                     <div style="font-weight: bold; margin-bottom: 8px; color: #0066cc;">
+                 <div class="post-card" style="border: 1px solid #ddd; padding: 8px; margin: 2px 0 0 0; border-radius: 8px; background: #f9f9f9; position: relative;" title="{content_safe}">
+                     <div style="font-weight: bold; margin-bottom: 4px; color: #0066cc;">
                          {title_safe} {'<span style="background: #ff4444; color: white; padding: 2px 6px; border-radius: 3px; font-size: 0.8em; margin-left: 8px;">New</span>' if is_new else ''}
                      </div>
-                     <div style="margin: 8px 0; color: #666; line-height: 1.4;">
+                     <div style="margin: 4px 0; color: #666; line-height: 1.3;">
                          {display_content}
                      </div>
-                     <div style="font-size: 0.9em; color: #888; border-top: 1px solid #eee; padding-top: 8px; margin-top: 8px; display: flex; justify-content: space-between; align-items: center;">
-                         <div style="display: flex; gap: 12px; align-items: center;">
+                     <div style="font-size: 0.9em; color: #888; border-top: 1px solid #eee; padding-top: 4px; margin-top: 4px; display: flex; justify-content: space-between; align-items: center;">
+                         <div style="display: flex; gap: 8px; align-items: center;">
                              <span>👤 {author_safe}</span>
                              <span>🕒 {post_time_safe}</span>
                              <span class="status-badge {get_status_class(status_safe)}">{status_safe}</span>
                          </div>
-                         <div style="display: flex; gap: 12px; align-items: center;">
+                         <div style="display: flex; gap: 8px; align-items: center;">
                              <span>💬 {comments}</span>
                              <span>👍 {likes}</span>
```

---

现在让我优化按钮行的布局，减少不必要的空白：


---

```diff
                      # 根据是否为admin调整布局
                      if is_admin:
-                         col1, col2, col3, col4, col5 = st.columns([8, 1, 1, 1, 1])
+                         col1, col2, col3, col4, col5 = st.columns([6, 1, 1, 1, 1])
                      else:
-                         col1, col2, col3, col4 = st.columns([6, 1, 1, 1])
+                         col1, col2, col3, col4 = st.columns([4, 1, 1, 1])
                      
                      with col1:
```

---

现在让我优化页面标题和导航栏的间距：


---

```diff
                  st.warning("暂无数据可导出")
      
-     st.divider()
-     
      # 检查是否有数据
      if not posts_data:
```

---

现在让我优化分页控件的间距：


---

```diff
      # 整合的分页控件 - 底部一行
      if total_pages > 1:
-         st.divider()
          col1, col2, col3, col4, col5 = st.columns([1, 1, 2, 1, 1])
          
```

---

现在让我添加一些额外的CSS样式来进一步减少间距：


---

```diff
      }
  
+     /* 减少Streamlit组件的默认间距 */
+     .stSubheader {
+         margin-bottom: 0.5rem !important;
+         padding-bottom: 0.25rem !important;
+     }
+     
+     .stTextInput, .stSelectbox, .stCheckbox, .stButton {
+         margin-bottom: 0.5rem !important;
+     }
+     
+     /* 减少容器的默认间距 */
+     .stContainer {
+         margin-bottom: 0.5rem !important;
+     }
+     
+     /* 优化按钮行的间距 */
+     .mini-button-row {
+         margin-top: 0.25rem !important;
+         margin-bottom: 0.25rem !important;
+     }
+     
+     /* 减少分页控件的间距 */
+     .stButton > button {
+         margin: 0.25rem !important;
+         padding: 0.25rem 0.5rem !important;
+     }
+     
+     /* 减少警告和成功消息的间距 */
+     .stAlert {
+         margin: 0.5rem 0 !important;
+         padding: 0.5rem !important;
+     }
+     
+     /* 减少数字输入框的间距 */
+     .stNumberInput {
+         margin-bottom: 0.25rem !important;
+     }
+ 
  /* 确保按钮完全覆盖卡片 */
  .stButton {
```

---

现在让我检查一下是否还有其他地方需要优化。让我查看主函数中的页面标题部分：


---

Read file: app.py

---

现在让我优化主函数中的页面标题间距：


---



---

让我添加一些额外的CSS样式来减少侧边栏和选项卡的间距：


---

```diff
      }
      
+     /* 减少侧边栏的间距 */
+     .css-1d391kg {
+         padding: 0.5rem !important;
+     }
+     
+     .css-1d391kg > div {
+         margin-bottom: 0.25rem !important;
+     }
+     
+     /* 减少选项卡的间距 */
+     .stTabs > div > div > div > div {
+         padding: 0.25rem !important;
+     }
+     
+     .stTabs > div > div > div > div > div {
+         margin: 0.125rem !important;
+     }
+     
+     /* 减少列布局的间距 */
+     .row-widget.stHorizontal > div {
+         margin: 0.125rem !important;
+     }
+     
+     /* 减少警告和错误消息的间距 */
+     .stAlert, .stWarning, .stError, .stSuccess {
+         margin: 0.25rem 0 !important;
+         padding: 0.5rem !important;
+     }
+     
+     /* 减少加载动画的间距 */
+     .stSpinner {
+         margin: 0.25rem !important;
+     }
+ 
  /* 确保按钮完全覆盖卡片 */
  .stButton {
```

---

现在让我检查一下是否还有其他需要优化的地方。让我查看一下"我要发声"选项卡的代码：


---

Read file: app.py

---

让我继续查看"我要发声"选项卡的剩余部分：


---

Read file: app.py

---

现在让我优化"我要发声"选项卡的间距：


---

```diff
              "问题详细描述 *", 
              placeholder="请详细描述您遇到的问题、影响和建议解决方案...",
-             height=200
+             height=150
          )
          
```

---

现在让我添加一些CSS样式来减少表单元素的间距：


---

```diff
      }
      
+     /* 减少表单元素的间距 */
+     .stForm {
+         margin-bottom: 0.5rem !important;
+     }
+     
+     .stForm > div {
+         margin-bottom: 0.25rem !important;
+     }
+     
+     .stForm .stMarkdown {
+         margin-bottom: 0.25rem !important;
+     }
+     
+     .stForm .stTextInput,
+     .stForm .stSelectbox,
+     .stForm .stTextArea,
+     .stForm .stFileUploader {
+         margin-bottom: 0.25rem !important;
+     }
+     
+     .stForm .stButton {
+         margin-top: 0.5rem !important;
+         margin-bottom: 0.25rem !important;
+     }
+     
+     /* 减少展开器的间距 */
+     .streamlit-expanderHeader {
+         padding: 0.25rem !important;
+         margin: 0.125rem 0 !important;
+     }
+     
+     .streamlit-expanderContent {
+         padding: 0.25rem !important;
+         margin: 0.125rem 0 !important;
+     }
+ 
  /* 确保按钮完全覆盖卡片 */
  .stButton {
```

---



---



---

